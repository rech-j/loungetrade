{% extends "base.html" %}
{% block title %}Notifications â€” Lounge Coin{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="flex items-center justify-between mb-8">
        <h1 class="font-serif text-2xl font-bold">Notifications</h1>
        {% if notifications %}
        <form method="post" action="{% url 'notifications_mark_all_read' %}">
            {% csrf_token %}
            <button type="submit" class="text-xs text-gold hover:text-gold-dark uppercase tracking-wide">Mark all read</button>
        </form>
        {% endif %}
    </div>

    {% if notifications %}
    <div class="border border-stone dark:border-slate divide-y divide-stone dark:divide-slate">
        {% for n in notifications %}
        <div class="px-4 py-3 {% if not n.is_read %}border-l-3 border-l-gold{% else %}opacity-60{% endif %}">
            <div class="flex items-start justify-between gap-4">
                <div class="flex-1">
                    {% if n.link %}
                    <a href="{{ n.link }}" class="text-sm font-medium hover:text-gold">{{ n.title }}</a>
                    {% else %}
                    <p class="text-sm font-medium">{{ n.title }}</p>
                    {% endif %}
                    <p class="text-sm text-slate mt-0.5">{{ n.message }}</p>
                    <p class="text-xs text-slate mt-1">{{ n.created_at|timesince }} ago</p>
                </div>
                {% if not n.is_read %}
                <form method="post" action="{% url 'notification_mark_read' n.pk %}">
                    {% csrf_token %}
                    <button type="submit" class="w-2 h-2 rounded-full bg-gold mt-1 flex-shrink-0" title="Mark read"></button>
                </form>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-slate text-sm">No notifications.</p>
    {% endif %}
</div>
{% endblock %}
